<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="hostMapper">
	<resultMap id="hostInfoResultSet" type="HostInfo">
		<result column="user_id" property="userId" />
		<result column="business_no" property="businessNo" />
		<result column="business_name" property="businessName" />
		<result column="business_license" property="businessLicense" />
		<result column="license_path" property="licensePath" />
		<result column="business_loc" property="businessLoc" />
		<result column="business_acc" property="businessAcc" />
		<result column="business_phone" property="businessPhone" />
		<result column="business_email" property="businessEmail" />
		<result column="host_status" property="hostStatus" />
	</resultMap>
	<resultMap id="spaceResultSet" type="Space">
		<result column="spc_no" property="spcNo" />
		<result column="spc_name" property="spcName" />
		<result column="spc_int" property="spcInt" />
		<result column="spc_long" property="spcLong" />
		<result column="spc_tag" property="spcTag" />
		<result column="spc_type" property="spcType" />
		<result column="spc_min" property="spcMin" />
		<result column="spc_max" property="spcMax" />
		<result column="spc_img" property="spcImg" />
		<result column="spc_chimg" property="spcChimg" />
		<result column="spc_price" property="spcPrice" />
		<result column="spc_hours" property="spcHours" />
		<result column="spc_holiday" property="spcHoliday" />
		<result column="spc_status" property="spcStatus" />
		<result column="spc_convn" property="spcConvn" />
		<result column="user_id" property="userId" />
		<result column="map_latitude" property="latitude" />
		<result column="map_longitude" property="longitude" />
		<result column="map_location" property="location" />
	</resultMap>
	 
	<resultMap id="selectQnaListResultSet" type="hostQna">
		<result column="qa_no" property="qaNo" />
		<result column="qa_content"  jdbcType="CLOB" javaType="java.lang.String" property="qaContent" />
		<result column="qa_writer" property="qaWriter" />
		<result column="qa_date" property="qaDate" />
		<result column="qa_answer" property="qaAnswer" />
		<result column="qa_status" property="qaStatus" />
		<result column="qa_secret" property="qaSecret" />
		<result column="user_id" property="userId" />
		<result column="spc_no" property="spcNo" />
		<result column="spc_name" property="spcName" />
		<result column="spc_type" property="spcType" />
	</resultMap> 
  <insert id="insertHost" parameterType="HostInfo">
	insert
	  into host_info
	  (
	     user_id
	    ,business_no
	    ,business_name
	    ,business_license
	    ,license_path
	    ,business_loc
	    ,business_acc
	    ,business_phone
	    ,business_email
	  )
	 values
	 (
	    #{userId}
	    ,#{businessNo}
	    ,#{businessName}
	    ,#{businessLicense}
	    ,#{licensePath}
	    ,#{businessLoc}
	    ,#{businessAcc}
	    ,#{businessPhone}
	    ,#{businessEmail}
	  )
  
  </insert>
  
  <update id="updateHost" parameterType="HostInfo">
  update 
		       host_info
		   set business_no = #{businessNo}
		     , business_name = #{businessName}
		     , business_license = #{businessLicense}
		     , license_path = #{licensePath}
		     , business_loc = #{businessLoc}
		     , business_acc = #{businessAcc}
             , business_phone = #{businessPhone}
             , "BUSINESS_EMAIL" = #{businessEmail}
		 where user_id = #{userId};
  
  </update>
  <select id="selectHost" parameterType="string" resultMap="hostInfoResultSet" >
  	select  
  			user_id 
  		   ,business_no
  		   ,business_name
  		   ,business_license
  		   ,license_path
  		   ,business_loc
  		   ,business_acc
  		   ,business_phone
  		   ,business_email
  		   ,host_status
	      
	  from  host_info
	 where  user_id =  #{userId}
  </select>
  <select id="selectSpaceList" parameterType="string" resultMap="spaceResultSet">
  	select
  		    spc_no
  		  , spc_name 
  		  , spc_int
  		  , spc_long
  		  , spc_tag
  		  , spc_type
  		  , spc_min
  		  , spc_max
  		  , spc_img
  		  , spc_chimg
  		  , spc_price
  		  , spc_hours
  		  , spc_holiday
  		  , spc_status
  		  , spc_convn
  		  , user_id
  		  , map_latitude
  		  , map_longitude
  		  , map_location
	from   space_info
   where  user_id = #{userId}
     and  spc_status = 'Y'
  </select>
 <select id="selectQnaListCount" parameterType="_int" resultType="_int">
  	select count(*)
	 from question_answer
	 where spc_no = #{spcNo}
	   and qa_status = 'Y'
  </select>
 <select id="selectQnaList" parameterType="_int" resultMap="selectQnaListResultSet">
	select 
	     qa_no
	    ,qa_content
	    ,qa_writer
	    ,qa_date
	    ,qa_answer
	    ,qa_status
	    ,qa_secret
	    ,q.user_id
	    ,q.spc_no
	    ,s.spc_name
	    ,s.spc_type
	  from question_answer q
	  join space_info s on(q.spc_no=s.spc_no)
	  where q.spc_no = #{spcNo}
	    and qa_status = 'Y'
  </select>
</mapper>
